# çŸ¥è­˜ãƒ™ãƒ¼ã‚¹1: æŠ€è¡“ä»•æ§˜

## ğŸ“¦ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### Backend
```
Django==5.2.6          # LTSç‰ˆï¼ˆ2028å¹´4æœˆã‚µãƒãƒ¼ãƒˆï¼‰
wagtail==7.0.6        # Django 5.2å¯¾å¿œ
djangorestframework==3.16.1
django-import-export==4.2.0
django-redis==5.4.0
psycopg2-binary==2.9.9
APScheduler==3.10.4    # ã‚¿ã‚¹ã‚¯ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼
```

### Frontend
```
next==16.0.0          # Turbopackæ¨™æº–æ­è¼‰
react==19.1.0
typescript==5.x
@tanstack/react-query==5.59.0
shadcn/ui
tailwindcss==3.x
next-devtools-mcp==latest  # MCPçµ±åˆ
```

### Infrastructure
```
PostgreSQL 14+ï¼ˆ13ã¯ã‚µãƒãƒ¼ãƒˆçµ‚äº†ï¼‰
Redis 5.1.0+
Docker Compose
```

## ğŸ— ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ§‹æˆ

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ï¼‰
- **Next.js 16.0.0**ï¼ˆApp Routerï¼‰
  - Turbopack: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæœ‰åŠ¹ï¼ˆãƒ“ãƒ«ãƒ‰2.6å€é«˜é€Ÿï¼‰
  - React 19ã‚µãƒãƒ¼ãƒˆ
  - Cache Componentså¯¾å¿œ
- **å½¹å‰²**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå®Ÿéš›ã«è¦‹ã‚‹ç”»é¢
- **ãƒ«ãƒ¼ãƒˆä¾‹**: `/tools/`, `/blog/`, `/ranking/`

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆAPI + CMSï¼‰
- **Django REST API**: ãƒ‡ãƒ¼ã‚¿æä¾›ï¼ˆJSONï¼‰
- **Wagtail CMS**: Headlessæ§‹æˆï¼ˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç®¡ç†ï¼‰
- **Django Templates**: **ç®¡ç†ç”»é¢ã®ã¿**
  - `/admin/`ï¼ˆDjango Adminï¼‰
  - `/cms/`ï¼ˆWagtail Adminï¼‰
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ç”»é¢ã«ã¯ä½¿ç”¨ã—ãªã„

### ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼
```
[ãƒ¦ãƒ¼ã‚¶ãƒ¼] 
    â†“
[Next.js 16 (ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰)]
    â†“ HTTP Request
[Django REST API]
    â†“ Query
[PostgreSQL / Redis]
```

## ğŸ”§ é–‹ç™ºãƒ„ãƒ¼ãƒ«

### Next.js DevToolsï¼ˆMCPçµ±åˆï¼‰
- **next-devtools-mcp**: Next.jsé–‹ç™ºã‚µãƒ¼ãƒãƒ¼æƒ…å ±ã‚’Claude Desktopã«æä¾›
- **æ©Ÿèƒ½**:
  - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼æ¤œå‡º
  - ãƒã‚¤ãƒ‰ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼æ¤œå‡º
  - ãƒ«ãƒ¼ãƒˆæƒ…å ±è‡ªå‹•å–å¾—
  - å‹ã‚¨ãƒ©ãƒ¼æ¤œå‡º
  - ç’°å¢ƒå¤‰æ•°ç¢ºèª

### Turbopackï¼ˆé«˜é€Ÿãƒ“ãƒ«ãƒ‰ï¼‰
- **Next.js 16ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæœ‰åŠ¹**
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**:
  - ãƒ“ãƒ«ãƒ‰é€Ÿåº¦: Webpackæ¯” 2.6å€é«˜é€Ÿ
  - HMR: 40-50%é«˜é€ŸåŒ–
  - ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡å‰Šæ¸›
- **ä½¿ç”¨æ–¹æ³•**: è‡ªå‹•æœ‰åŠ¹ï¼ˆè¨­å®šä¸è¦ï¼‰

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«

### Toolï¼ˆãƒ„ãƒ¼ãƒ«ï¼‰
```python
class Tool(models.Model):
    # è­˜åˆ¥å­
    id = models.UUIDField(primary_key=True, default=uuid.uuid4)
    slug = models.SlugField(unique=True, max_length=200)

    # åŸºæœ¬æƒ…å ±
    name = models.CharField(max_length=200)
    short_description = models.TextField(max_length=100)
    long_description = models.TextField()

    # åˆ†é¡
    platform = ArrayField(models.CharField(max_length=20))
    # å€¤: ['mt4'], ['mt5'], ['tradingview'], ['mt4', 'mt5']

    tool_type = models.CharField(max_length=20, choices=[
        ('EA', 'Expert Advisor'),
        ('Indicator', 'ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼'),
        ('Library', 'ãƒ©ã‚¤ãƒ–ãƒ©ãƒª'),
        ('Script', 'ã‚¹ã‚¯ãƒªãƒ—ãƒˆ'),
        ('Strategy', 'ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼'),
    ])

    price_type = models.CharField(max_length=20, choices=[
        ('free', 'ç„¡æ–™'),
        ('paid', 'æœ‰æ–™'),
        ('freemium', 'ãƒ•ãƒªãƒ¼ãƒŸã‚¢ãƒ '),
    ])

    # ãƒ¡ã‚¿æƒ…å ±
    image_url = models.URLField()
    external_url = models.URLField()
    metadata = models.JSONField(default=dict)

    # ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
```

### BlogPageï¼ˆWagtailãƒšãƒ¼ã‚¸ï¼‰
```python
from wagtail.models import Page
from wagtail.fields import StreamField

class BlogPage(Page):
    # ãƒ¡ã‚¿æƒ…å ±
    excerpt = models.TextField(max_length=200)
    category = models.CharField(max_length=30)
    investment_type = models.CharField(max_length=20)

    # ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼ˆStreamFieldï¼‰
    body = StreamField([...])  # è©³ç´°ã¯çŸ¥è­˜ãƒ™ãƒ¼ã‚¹2å‚ç…§

    # é–¢é€£
    featured_image = models.ForeignKey('wagtailimages.Image')
    related_tools = models.ManyToManyField(Tool, blank=True)

    # çµ±è¨ˆ
    view_count = models.IntegerField(default=0, editable=False)
```

### ToolStatsï¼ˆçµ±è¨ˆï¼‰
```python
class ToolStats(models.Model):
    tool = models.OneToOneField(Tool, on_delete=models.CASCADE)

    # é€±é–“çµ±è¨ˆ
    week_views = models.IntegerField(default=0)
    week_shares = models.IntegerField(default=0)
    week_avg_duration = models.FloatField(default=0)
    week_score = models.FloatField(default=0)
    prev_week_rank = models.IntegerField(null=True)

    # æ›´æ–°æ—¥æ™‚
    last_updated = models.DateTimeField(auto_now=True)
```

### EventLogï¼ˆã‚¤ãƒ™ãƒ³ãƒˆè¨˜éŒ²ï¼‰
```python
class EventLog(models.Model):
    EVENT_TYPES = [
        ('view', 'ãƒšãƒ¼ã‚¸é–²è¦§'),
        ('share', 'SNSã‚·ã‚§ã‚¢'),
        ('duration', 'æ»åœ¨æ™‚é–“'),
    ]

    tool = models.ForeignKey(Tool, on_delete=models.CASCADE)
    event_type = models.CharField(max_length=20, choices=EVENT_TYPES)
    created_at = models.DateTimeField(auto_now_add=True)
    duration_seconds = models.IntegerField(null=True)
    share_platform = models.CharField(max_length=20, null=True)
```

## ğŸš€ APIä»•æ§˜

### ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¸€è¦§

#### 1. ãƒ„ãƒ¼ãƒ«æ¤œç´¢
```
GET /api/tools/

ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:
- platform: mt4|mt5|tradingview
- tool_type: EA|Indicator|Library|Script|Strategy
- price_type: free|paid|freemium
- q: ãƒ•ãƒªãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢
- sort: -week_score|created_at|price
- page: ãƒšãƒ¼ã‚¸ç•ªå·

ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹:
{
  "results": [
    {
      "id": "uuid",
      "name": "Grid Master EA",
      "slug": "grid-master-ea",
      "platform": ["mt5"],
      "week_rank": 1,
      "week_score": 157.5
    }
  ],
  "count": 150
}
```

#### 2. ãƒ„ãƒ¼ãƒ«è©³ç´°
```
GET /api/tools/{slug}/

ãƒ¬ã‚¹ãƒãƒ³ã‚¹:
{
  "id": "uuid",
  "name": "Grid Master EA",
  "long_description": "è©³ç´°èª¬æ˜...",
  "stats": {
    "week_views": 250,
    "week_score": 157.5,
    "week_rank": 1,
    "rank_change": "â†‘3"
  }
}
```

#### 3. é€±é–“ãƒ©ãƒ³ã‚­ãƒ³ã‚°
```
GET /api/ranking/weekly/

ãƒ¬ã‚¹ãƒãƒ³ã‚¹:
{
  "updated_at": "2025-01-20T02:00:00Z",
  "rankings": [
    {
      "rank": 1,
      "rank_change": "NEW",
      "tool": {...},
      "score": 157.5
    }
  ]
}
```

#### 4. ã‚¤ãƒ™ãƒ³ãƒˆãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°
```
POST /api/events/track/

ãƒªã‚¯ã‚¨ã‚¹ãƒˆ:
{
  "target_type": "tool",
  "target_id": "uuid",
  "event_type": "view|share|duration",
  "duration_seconds": 120
}

ãƒ¬ã‚¹ãƒãƒ³ã‚¹: 204 No Content
```

## ğŸ—‚ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
toolradar/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ settings/
â”‚   â”‚   â”‚   â”œâ”€â”€ base.py
â”‚   â”‚   â”‚   â”œâ”€â”€ local.py
â”‚   â”‚   â”‚   â””â”€â”€ production.py
â”‚   â”‚   â””â”€â”€ urls.py
â”‚   â”‚
â”‚   â”œâ”€â”€ apps/
â”‚   â”‚   â”œâ”€â”€ tools/
â”‚   â”‚   â”‚   â”œâ”€â”€ models.py
â”‚   â”‚   â”‚   â”œâ”€â”€ serializers.py
â”‚   â”‚   â”‚   â”œâ”€â”€ views.py
â”‚   â”‚   â”‚   â”œâ”€â”€ scheduler.py  # APScheduler
â”‚   â”‚   â”‚   â””â”€â”€ management/commands/
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ blog/
â”‚   â”‚   â”‚   â”œâ”€â”€ models.py
â”‚   â”‚   â”‚   â”œâ”€â”€ blocks.py  # StreamField
â”‚   â”‚   â”‚   â””â”€â”€ wagtail_hooks.py
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ analytics/
â”‚   â”‚       â””â”€â”€ tasks.py  # ãƒ©ãƒ³ã‚­ãƒ³ã‚°é›†è¨ˆ
â”‚   â”‚
â”‚   â””â”€â”€ logs/  # APSchedulerãƒ­ã‚°
â”‚
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â””â”€â”€ tools/
â”‚   â”‚       â””â”€â”€ [slug]/
â”‚   â”‚           â””â”€â”€ page.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ ui/          # shadcn/ui
â”‚   â”‚   â””â”€â”€ features/
â”‚   â”‚
â”‚   â””â”€â”€ lib/
â”‚       â”œâ”€â”€ api.ts
â”‚       â””â”€â”€ utils.ts
â”‚
â””â”€â”€ docker-compose.yml
```

## ğŸ” èªè¨¼ãƒ»æ¨©é™

### APIèªè¨¼
- èª­ã¿å–ã‚ŠAPI: èªè¨¼ä¸è¦ï¼ˆå…¬é–‹ï¼‰
- æ›¸ãè¾¼ã¿API: Django Adminèªè¨¼å¿…é ˆ
- ã‚¤ãƒ™ãƒ³ãƒˆãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°: CORSåˆ¶é™ã®ã¿

### ç®¡ç†ç”»é¢
- Django Admin: `/admin/`
- Wagtail Admin: `/cms/`
- ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯

### CORSè¨­å®š
```python
CORS_ALLOWED_ORIGINS = [
    "http://localhost:3000",  # é–‹ç™º
    "https://toolradar.jp",  # æœ¬ç•ª
]
```

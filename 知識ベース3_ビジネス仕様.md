# 知識ベース3: ビジネス仕様

## 💰 マネタイズ戦略

### ASPアフィリエイト（主要収益源）

#### FX証券会社
| ASP | 証券会社 | 報酬目安 | 成果地点 |
|-----|---------|----------|----------|
| A8.net | DMM FX | 20,000円 | 口座開設+取引 |
| afb | GMOクリック証券 | 15,000円 | 口座開設+取引 |
| アクセストレード | ヒロセ通商 | 10,000円 | 口座開設 |
| バリューコマース | 外為どっとコム | 8,000円 | 口座開設 |
| A8.net | みんなのFX | 12,000円 | 口座開設+取引 |

#### 仮想通貨取引所
| ASP | 取引所 | 報酬目安 | 成果地点 |
|-----|--------|----------|----------|
| A8.net | Coincheck | 7,000円 | 口座開設 |
| afb | bitFlyer | 10,000円 | 口座開設+取引 |
| アクセストレード | GMOコイン | 3,000円 | 口座開設 |
| A8.net | DMM Bitcoin | 5,000円 | 口座開設 |

#### 配置戦略
```
記事構成での配置位置：
1. 導入部（10%）: 関心喚起
2. 中盤（40%）: 文脈に沿ったCTA
3. 記事末（90%）: メインCTA（最重要）
4. サイドバー: 常設ランキング
```

### Google AdSense配置

#### 配置ルール
```javascript
// 配置位置のdata属性
data-ad-slot="list-native"    // 一覧インフィード
data-ad-slot="detail-top"     // 詳細上部
data-ad-slot="detail-bottom"  // 詳細下部
data-ad-slot="blog-toc"       // ブログ目次後
data-ad-slot="blog-middle"    // ブログ中盤
data-ad-slot="blog-bottom"    // ブログ末尾

// 制限事項
- 1ページ最大3つ
- ファーストビュー避ける
- ASP CTAとの距離確保
```

## 📈 週間ランキング仕様

### スコア計算式
```python
# 週間スコア計算
WeeklyScore = (
    週間PV数 × 0.5 +           # 閲覧重視
    平均滞在時間(秒) ÷ 10 × 0.3 + # 質重視
    週間シェア数 × 2             # 拡散重視
)

# 計算例
PV: 100, 滞在: 60秒, シェア: 3
= (100 × 0.5) + (60 ÷ 10 × 0.3) + (3 × 2)
= 50 + 1.8 + 6
= 57.8ポイント
```

### イベント収集
```python
# view（ページ閲覧）
- 記録: tool_id, timestamp
- Bot除外: User-Agent判定
- 重複除外: 同一IPは1時間に1回

# duration（滞在時間）
- 記録: tool_id, seconds, timestamp
- 有効条件: 10秒以上
- 最大値: 600秒でカット

# share（SNSシェア）
- 記録: tool_id, platform, timestamp
- 対象: twitter, facebook, line, copy
```

### 順位変動表示
```python
def get_rank_change(current_rank, previous_rank):
    if previous_rank is None or previous_rank > 50:
        return "NEW"  # 新規ランクイン

    diff = previous_rank - current_rank
    if diff > 0:
        return f"↑{diff}"  # 上昇
    elif diff < 0:
        return f"↓{abs(diff)}"  # 下降
    else:
        return "→"  # 変動なし
```

### バッチ処理
```bash
# 毎日深夜2時実行
0 2 * * * python manage.py update_weekly_stats

# 処理内容
1. 直近7日間のEventLog集計
2. ツールごとにスコア計算
3. ToolStats更新
4. 前週順位を保存
5. Redis キャッシュ更新
```

## 🏷 タグ正規化

### 正規化フロー
```python
def normalize_tag(input_tag):
    """タグ正規化処理"""
    # 1. Unicode正規化（NFKC）
    tag = unicodedata.normalize('NFKC', input_tag)
    # 例: "ＲＳＩ" → "RSI"

    # 2. 小文字化
    tag = tag.lower()
    # 例: "RSI" → "rsi"

    # 3. 空白処理
    tag = tag.strip()
    tag = re.sub(r'\s+', ' ', tag)

    # 4. 特殊文字統一
    tag = tag.replace('＿', '_')
    tag = tag.replace('－', '-')
    tag = tag.replace('・', '.')

    # 5. synonymsマッチング
    matched_tag = Tag.objects.filter(
        Q(slug=tag) | Q(synonyms__contains=[tag])
    ).first()

    return matched_tag or create_new_tag(tag)
```

### タグマスターデータ

#### technical_indicator（テクニカル指標）
```python
TECHNICAL_INDICATORS = [
    {
        'name': 'RSI',
        'slug': 'rsi',
        'synonyms': ['ＲＳＩ', 'アールエスアイ', 'relative strength index'],
        'category': 'technical_indicator'
    },
    {
        'name': 'MACD',
        'slug': 'macd',
        'synonyms': ['マックディー', 'ＭＡＣＤ'],
        'category': 'technical_indicator'
    },
    {
        'name': '移動平均',
        'slug': 'ma',
        'synonyms': ['MA', 'moving average', 'ＭＡ', 'SMA', 'EMA'],
        'category': 'technical_indicator'
    },
    {
        'name': 'ボリンジャーバンド',
        'slug': 'bb',
        'synonyms': ['BB', 'Bollinger Bands', 'ボリバン'],
        'category': 'technical_indicator'
    },
]
```

#### trade_style（取引スタイル）
```python
TRADE_STYLES = [
    {
        'name': 'スキャルピング',
        'slug': 'scalping',
        'synonyms': ['scalp', 'スキャル', 'スキャ'],
        'category': 'trade_style'
    },
    {
        'name': 'デイトレード',
        'slug': 'day_trading',
        'synonyms': ['day trade', 'デイトレ'],
        'category': 'trade_style'
    },
    {
        'name': 'スイングトレード',
        'slug': 'swing',
        'synonyms': ['swing trading', 'スイング'],
        'category': 'trade_style'
    },
]
```

## 🔍 SEO最適化

### 構造化データ（JSON-LD）

#### ツール詳細ページ
```json
{
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "{{tool.name}}",
  "applicationCategory": "FinanceApplication",
  "applicationSubCategory": "TradingTool",
  "operatingSystem": "{{tool.platform|join:', '}}",
  "description": "{{tool.short_description}}",
  "image": "{{tool.image_url}}",
  "offers": {
    "@type": "Offer",
    "price": "{{tool.price|default:'0'}}",
    "priceCurrency": "USD"
  },
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "4.5",
    "ratingCount": "{{tool.stats.week_views}}"
  },
  "author": {
    "@type": "Organization",
    "name": "{{tool.metadata.developer}}"
  }
}
```

#### ブログ記事ページ
```json
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "{{page.title}}",
  "description": "{{page.excerpt}}",
  "image": "{{page.featured_image.url}}",
  "datePublished": "{{page.first_published_at|date:'c'}}",
  "dateModified": "{{page.last_published_at|date:'c'}}",
  "author": {
    "@type": "Organization",
    "name": "ToolRadar編集部"
  },
  "publisher": {
    "@type": "Organization",
    "name": "ToolRadar",
    "logo": {
      "@type": "ImageObject",
      "url": "https://toolradar.jp/logo.png"
    }
  }
}
```

### メタタグ設定
```html
<!-- ツール詳細ページ -->
<title>{{tool.name}} - {{tool.platform|join:'/'}}ツール | ToolRadar</title>
<meta name="description" content="{{tool.short_description|truncate:155}}">
<link rel="canonical" href="https://toolradar.jp/tools/{{tool.slug}}/">

<!-- OGP -->
<meta property="og:title" content="{{tool.name}}">
<meta property="og:description" content="{{tool.short_description}}">
<meta property="og:image" content="{{tool.image_url}}">
<meta property="og:type" content="product">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{tool.name}}">
<meta name="twitter:description" content="{{tool.short_description}}">
<meta name="twitter:image" content="{{tool.image_url}}">
```

### URL構造
```
# 階層構造
/                              # トップページ
/tools/                        # ツール一覧
/tools/mt4/                    # MT4ツール一覧
/tools/mt5/                    # MT5ツール一覧
/tools/tradingview/            # TradingViewツール一覧
/tools/{slug}/                 # ツール詳細
/ranking/weekly/               # 週間ランキング
/blog/                         # ブログトップ
/blog/{year}/{month}/{slug}/   # ブログ記事
/tags/{tag-slug}/              # タグアーカイブ
```

## 📊 コンテンツ戦略

### 記事カテゴリー別の収益化方針

#### 初心者ガイド
```
目的: 教育 + 口座開設誘導
構成:
- 基礎知識解説（40%）
- 実践方法（30%）
- おすすめ証券会社（20%） ← ASP
- 関連ツール紹介（10%）

ASP配置: 記事末尾に比較表
```

#### ツールレビュー
```
目的: ツール紹介 + 口座開設誘導
構成:
- ツール詳細解説（50%）
- 使い方・設定（30%）
- 必要な証券会社（15%） ← ASP
- 類似ツール（5%）

ASP配置: ツール利用前提として自然に紹介
```

#### ランキング特集
```
目的: 注目度向上 + 収益最大化
構成:
- ランキング結果（40%）
- 各ツール解説（40%）
- 始め方ガイド（15%） ← ASP
- まとめ（5%）

ASP配置: 複数箇所に分散配置
```

## 💡 A/Bテスト項目

### テスト対象
```javascript
// CTA文言
const ctaVariants = {
  A: "今すぐ口座開設",
  B: "無料で始める",
  C: "詳細を見る"
};

// ボタンカラー
const colorVariants = {
  A: "#007bff", // 青
  B: "#28a745", // 緑
  C: "#ff9800"  // オレンジ
};

// 配置位置
const positionVariants = {
  A: "記事中盤",
  B: "記事末尾",
  C: "両方"
};
```

### 計測指標
- CTR（クリック率）
- CVR（コンバージョン率）
- 滞在時間
- 直帰率
- スクロール深度

## 🎯 KPI目標

### 月次目標
| 指標 | 1ヶ月目 | 3ヶ月目 | 6ヶ月目 |
|------|---------|---------|---------|
| PV | 1,000 | 10,000 | 100,000 |
| UU | 500 | 5,000 | 30,000 |
| 記事数 | 10 | 50 | 150 |
| ツール数 | 50 | 150 | 300 |
| ASP成果 | 0件 | 10件 | 100件 |
| 収益 | 0円 | 10万円 | 100万円 |

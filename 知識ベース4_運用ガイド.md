# çŸ¥è­˜ãƒ™ãƒ¼ã‚¹4: é‹ç”¨ã‚¬ã‚¤ãƒ‰

## ï¿½ Dockerç’°å¢ƒ

### docker-compose.yml
```yaml
version: '3.8'

services:
  backend:
    build:
      context: ./backend
    ports:
      - "8000:8000"
    volumes:
      - ./backend:/app
    environment:
      - DEBUG=True
      - DATABASE_URL=postgresql://postgres:password@db:5432/toolradar
      - REDIS_URL=redis://redis:6379/0
    depends_on:
      - db
      - redis
    command: python manage.py runserver 0.0.0.0:8000

  frontend:
    build:
      context: ./frontend
    ports:
      - "3000:3000"
    volumes:
      - ./frontend:/app
      - /app/node_modules
    environment:
      - NEXT_PUBLIC_API_URL=http://localhost:8000/api
    command: npm run dev

  db:
    image: postgres:14-alpine
    environment:
      - POSTGRES_DB=toolradar
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=password
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"

  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data

volumes:
  postgres_data:
  redis_data:
```

### Dockeræ“ä½œã‚³ãƒãƒ³ãƒ‰

#### åŸºæœ¬æ“ä½œ
```bash
# å…¨ã‚µãƒ¼ãƒ“ã‚¹èµ·å‹•
docker compose up -d

# ãƒ­ã‚°ç¢ºèªï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ï¼‰
docker compose logs -f

# ç‰¹å®šã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ­ã‚°
docker compose logs -f backend
docker compose logs -f frontend

# å…¨ã‚µãƒ¼ãƒ“ã‚¹åœæ­¢
docker compose down

# ãƒœãƒªãƒ¥ãƒ¼ãƒ å«ã‚ã¦å‰Šé™¤
docker compose down -v

# å†ãƒ“ãƒ«ãƒ‰
docker compose build --no-cache

# ç‰¹å®šã‚µãƒ¼ãƒ“ã‚¹ã®ã¿å†èµ·å‹•
docker compose restart backend
```

#### ã‚³ãƒ³ãƒ†ãƒŠå†…æ“ä½œ
```bash
# Bashã‚·ã‚§ãƒ«èµ·å‹•
docker compose exec backend bash
docker compose exec frontend sh

# Djangoã‚·ã‚§ãƒ«
docker compose exec backend python manage.py shell_plus

# PostgreSQLæ¥ç¶š
docker compose exec db psql -U postgres -d toolradar

# Redis CLI
docker compose exec redis redis-cli
```

## ğŸ’» Djangoç®¡ç†ã‚³ãƒãƒ³ãƒ‰

### ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
```bash
# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
docker compose exec backend python manage.py makemigrations

# ç‰¹å®šã‚¢ãƒ—ãƒªã®ã¿
docker compose exec backend python manage.py makemigrations tools

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
docker compose exec backend python manage.py migrate

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹ç¢ºèª
docker compose exec backend python manage.py showmigrations

# ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆä¾‹: tools app ã® 0002 ã¾ã§ï¼‰
docker compose exec backend python manage.py migrate tools 0002
```

### ãƒ‡ãƒ¼ã‚¿ç®¡ç†
```bash
# ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ
docker compose exec backend python manage.py createsuperuser

# ãƒ‡ãƒ¼ã‚¿ãƒ€ãƒ³ãƒ—ï¼ˆJSONå½¢å¼ï¼‰
docker compose exec backend python manage.py dumpdata tools.Tool > tools_backup.json

# ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ‰
docker compose exec backend python manage.py loaddata tools_backup.json

# DBãƒªã‚»ãƒƒãƒˆï¼ˆæ³¨æ„ï¼ï¼‰
docker compose exec backend python manage.py flush --noinput
```

### é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
```bash
# é™çš„ãƒ•ã‚¡ã‚¤ãƒ«åé›†
docker compose exec backend python manage.py collectstatic --noinput

# ãƒ¡ãƒ‡ã‚£ã‚¢ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
docker compose exec backend python manage.py cleanup_unused_media
```

### ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç†
```bash
# Redisã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
docker compose exec redis redis-cli FLUSHALL

# Djangoã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
docker compose exec backend python manage.py clear_cache
```

## â° APSchedulerï¼ˆè‡ªå‹•ã‚¿ã‚¹ã‚¯å®Ÿè¡Œï¼‰

### ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼ã®èµ·å‹•ç¢ºèª

```bash
# Dockerã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•æ™‚ã«è‡ªå‹•èµ·å‹•
docker compose up -d

# ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼èµ·å‹•ãƒ­ã‚°ã‚’ç¢ºèª
docker compose logs backend | grep "ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼"

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# INFO ... ToolsConfig: ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼ã‚’èµ·å‹•ã—ã¾ã—ãŸ
# INFO ... ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼: ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚¸ãƒ§ãƒ–ã‚’ç™»éŒ²ã—ã¾ã—ãŸ
# INFO ... ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«: æ¯é€±æ—¥æ›œæ—¥ 03:00 JST
# INFO ... ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼: èµ·å‹•ã—ã¾ã—ãŸ
```

### å®Ÿè¡Œã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

| ã‚¸ãƒ§ãƒ–å | å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚° | å‡¦ç†å†…å®¹ |
|---------|--------------|---------|
| ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— | æ¯é€±æ—¥æ›œ 03:00 JST | 30æ—¥ä»¥ä¸Šå¤ã„ãƒ­ã‚°ã‚’å‰Šé™¤ |

### ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼ãƒ­ã‚°ã®ç¢ºèª

```bash
# ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼å°‚ç”¨ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«
docker compose exec backend cat logs/scheduler.log

# ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–
docker compose exec backend tail -f logs/scheduler.log

# å®Ÿè¡Œå±¥æ­´ã®ç¢ºèªï¼ˆæœ€æ–°50è¡Œï¼‰
docker compose exec backend tail -n 50 logs/scheduler.log
```

### æ‰‹å‹•ã§ã‚¸ãƒ§ãƒ–ã‚’å®Ÿè¡Œ

```bash
# æ–¹æ³•1: ç®¡ç†ã‚³ãƒãƒ³ãƒ‰
docker compose exec backend python manage.py cleanup_events

# æ–¹æ³•2: Pythonã‚·ã‚§ãƒ«ã‹ã‚‰
docker compose exec backend python manage.py shell
>>> from tools.scheduler import cleanup_old_events
>>> cleanup_old_events()

# æ–¹æ³•3: Adminç”»é¢ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
# http://localhost:8000/admin/tools/eventlog/
# â†’ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€ŒğŸ—‘ï¸ å¤ã„ãƒ­ã‚°ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ï¼ˆå®Ÿè¡Œï¼‰ã€
```

### ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

#### å®Ÿè¡Œæ™‚åˆ»ã®å¤‰æ›´

```python
# backend/tools/scheduler.py

# ä¾‹1: æ¯æ—¥æ·±å¤œ2æ™‚ã«å¤‰æ›´
scheduler.add_job(
    cleanup_old_events,
    trigger=CronTrigger(hour=2, minute=0),  # day_of_weekã‚’å‰Šé™¤
    id=job_id,
    name='ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—',
    replace_existing=True,
    max_instances=1
)

# ä¾‹2: æ¯é€±æœˆæ›œã¨æœ¨æ›œã®æ·±å¤œ3æ™‚
scheduler.add_job(
    cleanup_old_events,
    trigger=CronTrigger(day_of_week='mon,thu', hour=3, minute=0),
    id=job_id,
    name='ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—',
    replace_existing=True,
    max_instances=1
)
```

### ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

#### ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼ãŒèµ·å‹•ã—ãªã„

```bash
# 1. ãƒ­ã‚°ã‚’ç¢ºèª
docker compose logs backend | grep -i "scheduler\|ã‚¨ãƒ©ãƒ¼"

# 2. APSchedulerãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
docker compose exec backend pip show APScheduler

# 3. ã‚³ãƒ³ãƒ†ãƒŠã‚’å†èµ·å‹•
docker compose restart backend
```

#### ã‚¸ãƒ§ãƒ–ãŒå®Ÿè¡Œã•ã‚Œãªã„

```bash
# ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèª
docker compose exec backend python manage.py shell
>>> from tools.scheduler import start_scheduler
>>> scheduler = start_scheduler()
>>> print(scheduler.get_jobs())
>>> # ã‚¸ãƒ§ãƒ–ä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã‚‹

# ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ç¢ºèª
>>> from django.utils import timezone
>>> print(timezone.now())  # ç¾åœ¨æ™‚åˆ»ï¼ˆJSTï¼‰
```

## ğŸ¤– MCPé€£æºï¼ˆNext.js DevToolsï¼‰

### Claude Desktopè¨­å®š

#### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ç·¨é›†
```
å ´æ‰€: %APPDATA%\Claude\claude_desktop_config.json
```

```json
{
  "mcpServers": {
    "next-devtools": {
      "command": "npx",
      "args": ["-y", "next-devtools-mcp@latest"]
    }
  }
}
```

### ä½¿ã„æ–¹

#### 1. Next.jsé–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
```bash
docker compose up -d frontend

# èµ·å‹•ç¢ºèª
docker compose logs frontend | grep "Next.js"
# â†’ "â–² Next.js 16.0.0 (Turbopack)" è¡¨ç¤º
```

#### 2. Claude Desktopã§ç¢ºèª
```
Claude Desktopã‚’å†èµ·å‹•å¾Œã€ä»¥ä¸‹ãŒè‡ªå‹•çš„ã«åˆ©ç”¨å¯èƒ½ã«ï¼š
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼æ¤œå‡º
- ãƒã‚¤ãƒ‰ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼æ¤œå‡º
- ãƒ«ãƒ¼ãƒˆæƒ…å ±å–å¾—ï¼ˆ/api/*, /tools/*ç­‰ï¼‰
- å‹ã‚¨ãƒ©ãƒ¼æ¤œå‡º
- ç’°å¢ƒå¤‰æ•°ç¢ºèª
```

#### 3. æ´»ç”¨ä¾‹
```
ãƒ¦ãƒ¼ã‚¶ãƒ¼: "Next.jsã®ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèªã—ã¦"
Claude: [next-devtools-mcpçµŒç”±ã§ã‚¨ãƒ©ãƒ¼æƒ…å ±ã‚’å–å¾—]
        â†’ ãƒã‚¤ãƒ‰ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ã‚’æ¤œå‡ºãƒ»ä¿®æ­£ææ¡ˆ

ãƒ¦ãƒ¼ã‚¶ãƒ¼: "ã©ã‚“ãªãƒ«ãƒ¼ãƒˆãŒã‚ã‚‹ã‹æ•™ãˆã¦"
Claude: [next-devtools-mcpçµŒç”±ã§ãƒ«ãƒ¼ãƒˆæƒ…å ±ã‚’å–å¾—]
        â†’ /tools/, /blog/, /api/tools/ ç­‰ã‚’è¡¨ç¤º
```

## âš¡ Turbopacké–‹ç™ºãƒ¢ãƒ¼ãƒ‰

### ç¢ºèªæ–¹æ³•
```bash
# Next.js 16ã‹ã‚‰ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæœ‰åŠ¹
docker compose logs frontend | grep "Turbopack"
# â†’ "â–² Next.js 16.0.0 (Turbopack)" è¡¨ç¤ºã•ã‚Œã‚Œã°OK
```

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
- **ãƒ“ãƒ«ãƒ‰é€Ÿåº¦**: Webpackæ¯” 2.6å€é«˜é€Ÿ
- **HMRï¼ˆHot Module Replacementï¼‰**: 40-50%é«˜é€ŸåŒ–
- **ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡**: å‰Šæ¸›
- **è¨­å®š**: ä¸è¦ï¼ˆè‡ªå‹•æœ‰åŠ¹ï¼‰

### ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
```bash
# TurbopackãŒæœ‰åŠ¹åŒ–ã•ã‚Œã¦ã„ãªã„å ´åˆ
# 1. Next.js 16.0.0ä»¥é™ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
docker compose exec frontend npm list next

# 2. package.jsonã‚’ç¢ºèª
# "next": "16.0.0" ä»¥é™ã§ã‚ã‚‹ã“ã¨

# 3. ã‚³ãƒ³ãƒ†ãƒŠã‚’å†ãƒ“ãƒ«ãƒ‰
docker compose build frontend --no-cache
docker compose up -d frontend
```

## ğŸ“ˆ ã‚«ã‚¹ã‚¿ãƒ ç®¡ç†ã‚³ãƒãƒ³ãƒ‰

### update_weekly_stats
```bash
# é€±é–“çµ±è¨ˆæ›´æ–°ï¼ˆé€šå¸¸å®Ÿè¡Œï¼‰
docker compose exec backend python manage.py update_weekly_stats

# éå»14æ—¥é–“ã§é›†è¨ˆ
docker compose exec backend python manage.py update_weekly_stats --days=14

# ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³ï¼ˆDBæ›´æ–°ãªã—ï¼‰
docker compose exec backend python manage.py update_weekly_stats --dry-run

# crontabè¨­å®šï¼ˆãƒ›ã‚¹ãƒˆå´ï¼‰
0 2 * * * cd /path/to/project && docker compose exec -T backend python manage.py update_weekly_stats >> /var/log/ranking.log 2>&1
```

### cleanup_events
```bash
# 30æ—¥ã‚ˆã‚Šå¤ã„ãƒ­ã‚°å‰Šé™¤ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
docker compose exec backend python manage.py cleanup_events

# 60æ—¥ã‚ˆã‚Šå¤ã„ãƒ­ã‚°å‰Šé™¤
docker compose exec backend python manage.py cleanup_events --days=60

# ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³
docker compose exec backend python manage.py cleanup_events --dry-run

# crontabè¨­å®šï¼ˆé€±æ¬¡ï¼‰
0 3 * * 0 cd /path/to/project && docker compose exec -T backend python manage.py cleanup_events >> /var/log/cleanup.log 2>&1
```

### generate_test_events
```bash
# ãƒ†ã‚¹ãƒˆã‚¤ãƒ™ãƒ³ãƒˆç”Ÿæˆï¼ˆé–‹ç™ºç”¨ï¼‰
docker compose exec backend python manage.py generate_test_events --events=1000

# æ—¢å­˜ãƒ‡ãƒ¼ã‚¿å‰Šé™¤ã—ã¦ç”Ÿæˆ
docker compose exec backend python manage.py generate_test_events --events=1000 --clean

# 30æ—¥é–“ã«åˆ†æ•£ã—ã¦ç”Ÿæˆ
docker compose exec backend python manage.py generate_test_events --events=5000 --days=30
```

## ğŸ§  Wagtailç®¡ç†

### ãƒšãƒ¼ã‚¸ç®¡ç†
```bash
# ãƒšãƒ¼ã‚¸ãƒ„ãƒªãƒ¼ç¢ºèª
docker compose exec backend python manage.py fixtree

# ãƒšãƒ¼ã‚¸ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³å‰Šé™¤
docker compose exec backend python manage.py purge_revisions

# æ¤œç´¢ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ›´æ–°
docker compose exec backend python manage.py update_index
```

### ç”»åƒæœ€é©åŒ–
```bash
# Wagtailç”»åƒã®ã‚µãƒ ãƒã‚¤ãƒ«å†ç”Ÿæˆ
docker compose exec backend python manage.py regenerate_renditions

# æœªä½¿ç”¨ç”»åƒã®å‰Šé™¤
docker compose exec backend python manage.py delete_unused_images
```

## ğŸ“¦ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†

### Pythonï¼ˆpipï¼‰
```bash
# ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
docker compose exec backend pip install package_name

# requirements.txt ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
docker compose exec backend pip install -r requirements/local.txt

# ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ›´æ–°
docker compose exec backend pip install --upgrade package_name

# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ç¢ºèª
docker compose exec backend pip list
docker compose exec backend pip freeze
```

### JavaScriptï¼ˆnpmï¼‰
```bash
# npmã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
docker compose exec frontend npm install
docker compose exec frontend npm install package_name

# é–‹ç™ºä¾å­˜é–¢ä¿‚
docker compose exec frontend npm install -D package_name

# ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ›´æ–°
docker compose exec frontend npm update
docker compose exec frontend npm audit fix

# ãƒ“ãƒ«ãƒ‰
docker compose exec frontend npm run build
```

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †

### æœ¬ç•ªç’°å¢ƒæº–å‚™

#### ç’°å¢ƒå¤‰æ•°ï¼ˆ.env.productionï¼‰
```env
# Django
DEBUG=False
SECRET_KEY=your-secret-key-here
ALLOWED_HOSTS=toolradar.jp,www.toolradar.jp

# Database
DATABASE_URL=postgresql://user:pass@host:5432/toolradar

# Redis
REDIS_URL=redis://redis:6379/0

# AWS S3ï¼ˆé™çš„ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
AWS_ACCESS_KEY_ID=your-key
AWS_SECRET_ACCESS_KEY=your-secret
AWS_STORAGE_BUCKET_NAME=toolradar-static

# Sentryï¼ˆã‚¨ãƒ©ãƒ¼ç›£è¦–ï¼‰
SENTRY_DSN=https://xxx@sentry.io/xxx
```

#### Vercelï¼ˆFrontendï¼‰
```bash
# Vercelãƒ‡ãƒ—ãƒ­ã‚¤
vercel --prod

# ç’°å¢ƒå¤‰æ•°è¨­å®š
vercel env add NEXT_PUBLIC_API_URL
vercel env add NEXT_PUBLIC_GA_ID
```

#### Fly.ioï¼ˆBackendï¼‰
```bash
# Fly.ioãƒ‡ãƒ—ãƒ­ã‚¤
flyctl deploy
flyctl secrets set SECRET_KEY=xxx
```

## ğŸ” ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨å¯¾å‡¦

#### ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼
```bash
# ã‚¨ãƒ©ãƒ¼: relation "tools_tool" does not exist
# å¯¾å‡¦:
docker compose exec backend python manage.py migrate tools --fake-initial

# ã‚¨ãƒ©ãƒ¼: Conflicting migrations detected
# å¯¾å‡¦:
docker compose exec backend python manage.py makemigrations --merge
```

#### æ¨©é™ã‚¨ãƒ©ãƒ¼
```bash
# ã‚¨ãƒ©ãƒ¼: Permission denied
# å¯¾å‡¦: Dockerãƒ•ã‚¡ã‚¤ãƒ«å†…ã§æ¨©é™è¨­å®š
RUN chown -R django:django /app
```

#### ãƒ¡ãƒ¢ãƒªä¸è¶³
```bash
# ã‚¨ãƒ©ãƒ¼: Cannot allocate memory
# å¯¾å‡¦: docker-compose.yml ã§åˆ¶é™è¨­å®š
services:
  backend:
    deploy:
      resources:
        limits:
          memory: 2G
```

#### ãƒãƒ¼ãƒˆç«¶åˆ
```bash
# ã‚¨ãƒ©ãƒ¼: bind: address already in use
# å¯¾å‡¦: ä½¿ç”¨ä¸­ã®ãƒ—ãƒ­ã‚»ã‚¹ç¢ºèªã¨åœæ­¢
sudo lsof -i :8000
sudo kill -9 <PID>
```

## ğŸ“Š ç›£è¦–ãƒ»ãƒ­ã‚°

### ãƒ­ã‚°ç¢ºèª
```bash
# Djangoãƒ­ã‚°
docker compose exec backend tail -f logs/django.log

# Nginxãƒ­ã‚°ï¼ˆæœ¬ç•ªç’°å¢ƒï¼‰
docker compose exec nginx tail -f /var/log/nginx/access.log

# ã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚°
docker compose logs --tail=100 --follow
```

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–
```bash
# Django Debug Toolbarç¢ºèª
# http://localhost:8000/__debug__/

# PostgreSQL ã‚¹ãƒ­ãƒ¼ã‚¯ã‚¨ãƒª
docker compose exec db psql -U postgres -c "
SELECT query, calls, mean_exec_time
FROM pg_stat_statements
ORDER BY mean_exec_time DESC
LIMIT 10;"

# Redis ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°
docker compose exec redis redis-cli monitor
```

## ğŸ” ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

### è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```bash
#!/bin/bash
# backup.sh

DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/backup/toolradar"

# PostgreSQLãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
docker compose exec -T db pg_dump -U postgres toolradar > ${BACKUP_DIR}/db_${DATE}.sql

# ãƒ¡ãƒ‡ã‚£ã‚¢ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
tar czf ${BACKUP_DIR}/media_${DATE}.tar.gz ./media/

# Redisãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
docker compose exec -T redis redis-cli BGSAVE

# å¤ã„ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å‰Šé™¤ï¼ˆ30æ—¥ä»¥ä¸Šï¼‰
find ${BACKUP_DIR} -type f -mtime +30 -delete

echo "Backup completed: ${DATE}"
```

### ãƒªã‚¹ãƒˆã‚¢æ‰‹é †
```bash
# PostgreSQLãƒªã‚¹ãƒˆã‚¢
docker compose exec -T db psql -U postgres toolradar < backup.sql

# ãƒ¡ãƒ‡ã‚£ã‚¢ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆã‚¢
tar xzf media_backup.tar.gz -C ./

# Redisãƒªã‚¹ãƒˆã‚¢
docker compose exec redis redis-cli FLUSHALL
docker compose exec -T redis redis-cli < redis_backup.rdb
```

## ğŸ¯ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] ç’°å¢ƒå¤‰æ•°è¨­å®šå®Œäº†
- [ ] DEBUG=Falseç¢ºèª
- [ ] é™çš„ãƒ•ã‚¡ã‚¤ãƒ«åé›†å®Ÿè¡Œ
- [ ] ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
- [ ] SSLè¨¼æ˜æ›¸è¨­å®š
- [ ] CORSè¨­å®šç¢ºèª
- [ ] ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®š
- [ ] ç›£è¦–ãƒ„ãƒ¼ãƒ«è¨­å®š
- [ ] ã‚¨ãƒ©ãƒ¼é€šçŸ¥è¨­å®š
- [ ] ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼è¨­å®š
